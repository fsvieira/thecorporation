{"version":3,"sources":["engine/core/service-worker.js"],"names":["name","version","files","self","addEventListener","event","skipWaiting","waitUntil","caches","open","then","cache","addAll","keys","keyList","Promise","all","map","key","delete","clients","claim","request","method","respondWith","match","cached","unableToResolve","Response","status","statusText","headers","Headers","networked","fetch","fetchedFromNetwork","response","cacheCopy","clone","put","catch"],"mappings":";AAAA,aAGA,IAAMA,EAAO,aAIPC,EAAU,QAEVC,EAAQ,CAEb,IAGA,gBAGA,6BACA,4BAGA,aAGA,iBAGA,gBACA,gBACA,eACA,aAGA,cACA,8BACA,8BACA,8BACA,8BACA,8BACA,gCACA,gCACA,gCACA,gCACA,gCACA,gCACA,gCACA,gCACA,gCACA,iCAGDC,KAAKC,iBAAkB,UAAW,SAACC,GAClCF,KAAKG,cACLD,EAAME,UACLC,OAAOC,KAAST,GAAAA,OAAAA,EAASC,MAAAA,OAAAA,IAAWS,KAAM,SAACC,GACnCA,OAAAA,EAAMC,OAAQV,QAKxBC,KAAKC,iBAAkB,WAAY,SAACC,GAU5BF,OATPE,EAAME,UACLC,OAAOK,OAAQH,KAAM,SAACI,GACdC,OAAAA,QAAQC,IAAKF,EAAQG,IAAK,SAACC,GAC7BA,GAAAA,IAAWlB,GAAAA,OAAAA,EAASC,MAAAA,OAAAA,GAChBO,OAAAA,OAAOW,OAAQD,SAKnBf,KAAKiB,QAAQC,UAGrBlB,KAAKC,iBAAkB,QAAS,SAACC,GAEH,QAAzBA,EAAMiB,QAAQC,QAIlBlB,EAAMmB,YACLhB,OAAOiB,MAAOpB,EAAMiB,SAASZ,KAAM,SAACgB,GAU1BC,SAAAA,IACD,OAAA,IAAIC,SAER,8oBAAA,CACFC,OAAQ,IACRC,WAAY,sBACZC,QAAS,IAAIC,QAAS,CACL,eAAA,gBAKbC,IAAAA,EAAYC,MAAO7B,EAAMiB,SAC7BZ,KAtBOyB,SAAoBC,GACtBC,IAAAA,EAAYD,EAASE,QAKpBF,OAHP5B,OAAOC,KAAST,GAAAA,OAAAA,EAASC,MAAAA,OAAAA,IAAWS,KAAM,SAAcC,GACvDA,EAAM4B,IAAKlC,EAAMiB,QAASe,KAEpBD,GAgBoBT,GAC1Ba,MAAOb,GAEFD,OAAAA,GAAUO","file":"service-worker.js","sourceRoot":"../src","sourcesContent":["'use strict';\n\n// The name of your game, no spaces or special characters.\nconst name = 'Monogatari';\n\n// The version of the cache, changing this will force everything to be cached\n// again.\nconst version = '0.1.0';\n\nconst files = [\n\n\t'/',\n\n\t// General Files\n\t'manifest.json',\n\n\t// Engine Files\n\t'engine/core/monogatari.css',\n\t'engine/core/monogatari.js',\n\n\t// HTML Files\n\t'index.html',\n\n\t// Style Sheets\n\t'style/main.css',\n\n\t// JavaScript Files\n\t'js/options.js',\n\t'js/storage.js',\n\t'js/script.js',\n\t'js/main.js',\n\n\t// App Images\n\t'favicon.ico',\n\t'assets/icons/icon_48x48.png',\n\t'assets/icons/icon_60x60.png',\n\t'assets/icons/icon_70x70.png',\n\t'assets/icons/icon_76x76.png',\n\t'assets/icons/icon_96x96.png',\n\t'assets/icons/icon_120x120.png',\n\t'assets/icons/icon_128x128.png',\n\t'assets/icons/icon_150x150.png',\n\t'assets/icons/icon_152x152.png',\n\t'assets/icons/icon_167x167.png',\n\t'assets/icons/icon_180x180.png',\n\t'assets/icons/icon_192x192.png',\n\t'assets/icons/icon_310x150.png',\n\t'assets/icons/icon_310x310.png',\n\t'assets/icons/icon_512x512.png'\n];\n\nself.addEventListener ('install', (event) => {\n\tself.skipWaiting ();\n\tevent.waitUntil (\n\t\tcaches.open (`${name}-v${version}`).then ((cache) => {\n\t\t\treturn cache.addAll (files);\n\t\t})\n\t);\n});\n\nself.addEventListener ('activate', (event) => {\n\tevent.waitUntil (\n\t\tcaches.keys ().then ((keyList) => {\n\t\t\treturn Promise.all (keyList.map ((key) => {\n\t\t\t\tif (key !== `${name}-v${version}`) {\n\t\t\t\t\treturn caches.delete (key);\n\t\t\t\t}\n\t\t\t}));\n\t\t})\n\t);\n\treturn self.clients.claim ();\n});\n\nself.addEventListener ('fetch', (event) => {\n\n\tif (event.request.method !== 'GET') {\n\t\treturn;\n\t}\n\n\tevent.respondWith (\n\t\tcaches.match (event.request).then ((cached) => {\n\t\t\tfunction fetchedFromNetwork (response) {\n\t\t\t\tconst cacheCopy = response.clone ();\n\n\t\t\t\tcaches.open (`${name}-v${version}`).then (function add (cache) {\n\t\t\t\t\tcache.put (event.request, cacheCopy);\n\t\t\t\t});\n\t\t\t\treturn response;\n\t\t\t}\n\n\t\t\tfunction unableToResolve () {\n\t\t\t\treturn new Response (`\n\t\t\t\t\t<!DOCTYPE html><html lang=en><title>Bad Request</title><meta charset=UTF-8><meta content=\"width=device-width,initial-scale=1\"name=viewport><style>body,html{width:100%;height:100%}body{text-align:center;color:#545454;margin:0;display:flex;justify-content:center;align-items:center;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen,Ubuntu,Cantarell,\"Open Sans\",\"Fira Sans\",\"Droid Sans\",\"Helvetica Neue\",sans-serif}h1,h2{font-weight:lighter}h1{font-size:4em}h2{font-size:2em}</style><div><h1>Service Unavailable</h1><h2>Sorry, the server is currently unavailable or under maintenance, try again later.</h2></div>\n\t\t\t\t`, {\n\t\t\t\t\tstatus: 503,\n\t\t\t\t\tstatusText: 'Service Unavailable',\n\t\t\t\t\theaders: new Headers ({\n\t\t\t\t\t\t'Content-Type': 'text/html'\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst networked = fetch (event.request)\n\t\t\t\t.then (fetchedFromNetwork, unableToResolve)\n\t\t\t\t.catch (unableToResolve);\n\n\t\t\treturn cached || networked;\n\t\t})\n\t);\n});"]}